import{_ as z}from"./index.vue_vue_type_script_setup_true_lang-BHms0YAU.js";import{u as T,a as J,b as W}from"./equipment-category-CrxMcAcV.js";import{F as E,_ as Z,I as L}from"./index-DTvfgQe8.js";import{M as Q}from"./index-DewwF9gK.js";import{d as D,a4 as U,w as I,E as x,F as b,G as l,c as n,a5 as K,l as o,a6 as X,t as F,a2 as P,a3 as Y,M as R,O as w,J as C,Z as $,a7 as ee,a1 as te,a as oe,H as S,a8 as ae}from"./index-DV7Tvt5Y.js";import{_ as ne,B as M}from"./TextArea-BjtsIsZn.js";import{P as se}from"./index-Db-an7ty.js";import{E as ie,T as le}from"./navs-BD3d0_6e.js";import{C as re,S as de}from"./index-B1ztuN38.js";import{_ as pe}from"./index-CVdO9TpD.js";import{D as me}from"./DeleteOutlined-Cw3tThIH.js";import{_ as ue}from"./index-BHtfOZ07.js";import"./index-BbVrix12.js";import"./DownOutlined-D--NuR7i.js";import"./useRequest-Dz7y7lr_.js";import"./responsiveObserve-DeVBohwv.js";import"./isPlainObject-BWkeKT7j.js";import"./Col-B8xDw5VW.js";import"./pickAttrs-BWmeWkVt.js";import"./index-eZogoHkx.js";import"./isMobile-BbN7I0i_.js";import"./index-5hWegm85.js";import"./index-BCUw_SCa.js";import"./List-BmaGCUCT.js";import"./eagerComputed-BvJDvKzU.js";import"./index-_wvjrq5s.js";const O=D({__name:"ModalForm",props:{title:{},open:{type:Boolean},disabled:{type:Boolean},initData:{}},emits:["update:open","submit"],setup(N,{expose:y,emit:k}){const i=N,c=k,r=U({id:void 0,parentId:void 0,idPath:"",categoryNamePath:"",categoryName:"",description:""});I(()=>i.initData,e=>{e?Object.assign(r,e):f()},{immediate:!0}),I(()=>i.open,e=>{e||f()});const{validate:_,resetFields:f,validateInfos:u}=E.useForm(r,U({categoryName:[{required:!0,message:"请输入分类名称"}],description:[{required:!1,message:"请输入分类描述"}]})),g=()=>{_().then(()=>{c("submit",X(r))}).catch(e=>{})};return y({resetFields:f}),(e,t)=>{const a=L,d=Z,p=ne,v=E,s=Q;return b(),x(s,{title:e.title,open:e.open,"confirm-loading":e.disabled,"onUpdate:open":t[2]||(t[2]=m=>e.$emit("update:open",m)),onOk:g},{default:l(()=>[n(v,{disabled:e.disabled,layout:"vertical",autocomplete:"off"},{default:l(()=>[n(d,K({name:"categoryName",label:"分类名称"},o(u).categoryName),{default:l(()=>[n(a,{value:o(r).categoryName,"onUpdate:value":t[0]||(t[0]=m=>o(r).categoryName=m),placeholder:"请输入分类名称","allow-clear":""},null,8,["value"])]),_:1},16),n(d,K({name:"description",label:"描述"},o(u).description),{default:l(()=>[n(p,{value:o(r).description,"onUpdate:value":t[1]||(t[1]=m=>o(r).description=m),placeholder:"请输入分类描述","auto-size":{minRows:5,maxRows:10},"allow-clear":""},null,8,["value"])]),_:1},16)]),_:1},8,["disabled"])]),_:1},8,["title","open","confirm-loading"])}}}),ce=D({__name:"AddModalFormButton",props:{initData:{}},emits:["finish"],setup(N,{emit:y}){const k=y,i=F(!1),[c,r]=P.useMessage(),_=Y("formRef"),{isFetching:f,execute:u,onFetchResponse:g}=T("post");g(async t=>{var p;const{code:a,message:d}=t;if(a!==0){c.error(d);return}k("finish"),(p=_.value)==null||p.resetFields(),i.value=!1,c.success("新增成功")});const e=t=>{t.categoryNamePath=t.categoryNamePath.replace("$",t.categoryName),u(t)};return(t,a)=>{const d=M;return b(),R(w,null,[n(d,{type:"text",onClick:a[0]||(a[0]=p=>i.value=!0)},{icon:l(()=>[n(o(se))]),default:l(()=>[a[2]||(a[2]=C(" 新增分类 "))]),_:1,__:[2]}),n(O,{ref_key:"formRef",ref:_,title:"新增分类","init-data":t.initData,disabled:o(f),open:o(i),"onUpdate:open":a[1]||(a[1]=p=>$(i)?i.value=p:null),onSubmit:e},null,8,["init-data","disabled","open"]),n(o(r))],64)}}}),_e=D({__name:"UpdateModalFormButton",props:{initData:{},disabled:{type:Boolean}},emits:["finish"],setup(N,{emit:y}){const k=y,i=F(!1),[c,r]=P.useMessage(),{isFetching:_,execute:f,onFetchResponse:u}=T("put");u(async e=>{const{code:t,message:a}=e;if(t!==0){c.error(a);return}k("finish"),i.value=!1,c.success("修改成功")});const g=({id:e,categoryNamePath:t,categoryName:a,description:d})=>{const p=t.split("-");p.pop(),p.push(a),t=p.join("-"),f({id:e,categoryNamePath:t,categoryName:a,description:d})};return(e,t)=>{const a=M;return b(),R(w,null,[n(a,{type:"text",disabled:e.disabled,onClick:t[0]||(t[0]=d=>i.value=!0)},{icon:l(()=>[n(o(ie))]),default:l(()=>[t[2]||(t[2]=C(" 编辑 "))]),_:1,__:[2]},8,["disabled"]),e.initData?(b(),x(O,{key:0,title:"修改分类","init-data":e.initData,disabled:o(_),open:o(i),"onUpdate:open":t[1]||(t[1]=d=>$(i)?i.value=d:null),onSubmit:g},null,8,["init-data","disabled","open"])):ee("",!0),n(o(r))],64)}}}),fe={class:"mb-4 flex justify-between"},Ae=D({__name:"index",setup(N){te({title:"IE WorkSpace | 设备分类"});const{data:y,execute:k,isFetching:i}=J(),{execute:c,onFetchResponse:r}=W(),[_,f]=P.useMessage(),u=F([]),g=F([]),e=F(null),t=oe(()=>{var v,s,m,h;return{id:void 0,level:(v=e.value)!=null&&v.level?e.value.level+1:1,parentId:(s=e.value)==null?void 0:s.id,idPath:(m=e.value)!=null&&m.idPath?`${e.value.idPath}-$`:"",categoryNamePath:(h=e.value)!=null&&h.categoryNamePath?`${e.value.categoryNamePath}-$`:"",categoryName:"",description:""}}),a=()=>{k(),u.value=[],e.value=null};r(async v=>{const{code:s,message:m}=v;if(s!==0){_.error(m);return}a(),_.success("删除成功")});const d=(v,{selectedNodes:s})=>{e.value=s[0]},p=()=>{e.value&&c(e.value.id+"")};return(v,s)=>{const m=le,h=M,q=pe,H=de,A=ue,V=ae,j=re,G=z;return b(),R(w,null,[n(G,null,{default:l(()=>[n(j,null,{default:l(()=>[S("div",fe,[n(m,{level:5},{default:l(()=>s[2]||(s[2]=[C("分类树形列表")])),_:1,__:[2]}),S("div",null,[n(ce,{"init-data":o(t),onFinish:a},null,8,["init-data"]),n(_e,{"init-data":o(e),disabled:!o(e),onFinish:a},null,8,["init-data","disabled"]),n(q,{title:"确认要删除该分类吗?","ok-text":"确认","cancel-text":"取消",disabled:!o(e),onConfirm:p},{default:l(()=>[n(h,{type:"text",danger:"",disabled:!o(e)},{icon:l(()=>[n(o(me))]),default:l(()=>[s[3]||(s[3]=C(" 删除"))]),_:1,__:[3]},8,["disabled"])]),_:1},8,["disabled"])])]),o(i)?(b(),x(H,{key:0,active:""})):o(y).length?(b(),x(A,{key:1,selectedKeys:o(u),"onUpdate:selectedKeys":s[0]||(s[0]=B=>$(u)?u.value=B:null),"expanded-keys":o(g),"onUpdate:expandedKeys":s[1]||(s[1]=B=>$(g)?g.value=B:null),"block-node":"","tree-data":o(y),fieldNames:{title:"categoryName",key:"id",children:"children"},onSelect:d},null,8,["selectedKeys","expanded-keys","tree-data"])):(b(),x(V,{key:2,description:"暂无分类"}))]),_:1})]),_:1}),n(o(f))],64)}}});export{Ae as default};
